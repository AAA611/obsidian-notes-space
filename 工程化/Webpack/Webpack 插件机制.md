## 一、插件机制

软件插件机制是一种设计模式，允许应用程序通过加载额外的代码模块（插件）来扩展其功能。这种机制为软件提供了高度的**可扩展性**和**灵活性**。
### 1-1、插件机制的基本概念

1. **插件（Plugin）**
	- 插件时一个**独立**的模块，遵循特定的接口和协议，可以被主程序加载和调用，从而扩展住应用程序的功能。插件通常是动态加载的，可以在运行时增加、移除或者替换。
2. **主程序（Host Application）**
	- 主应用程序是插件的运行环境，它提供基本功能和服务，为插件提供上下文，并定义插件可以扩展的接口，主程序负责管理插件的加载、初始化和调用。
3. **插件接口（Plugin Interface）**
	- 插件接口时主应用程序和插件之间的约定，定义了插件必须实现的功能。这些接口确保住应用程序可以与插件进行通信和交互，也确保了整个应用和插件系统可以正常运行。
### 1-2、插件机制的优势

1. **可扩展性**
	 - **可扩展性**算是插件机制最大的优势之一，在开发软件（主应用程序）时，我们一般只关注核心功能的开发，但是我们仍然希望软件可以根据需要添加新的功能点。插件可以在无需修改主应用程序的情况下为主应用扩展新的功能。
2. **模块化**
     - 插件将功能封装在独立的模块中，这种设计方式使得插件更容易维护和传播复用。也更易于进行独立开发和测试。
3. **灵活性**
	 - 插件可以跟根据需要进行动态加载、移除或者替换，这使得应用程序可以根据不同的场景动态调整整个应用程序的功能。
4. **社区**
	- 设计了插件机制的软件大多拥有比较活跃的社区，可以快速丰富软件的功能与生态。

## 二、Webpack 插件是什么

插件机制是一个用于扩展 `Webpack` 功能的一种机制。它给 `Webpack` 创造了更多可能！

从形态上看，`webpack` **插件**是一个具有 [`apply`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply) 方法的 `JavaScript` 对象。`apply` 方法会被 `webpack compiler` 调用，并且在 **整个** 编译生命周期都可以访问 `compiler` 对象。

```javascript
const pluginName = 'ConsoleLogOnBuildWebpackPlugin';

class ConsoleLogOnBuildWebpackPlugin {
  apply(compiler) {
    compiler.hooks.run.tap(pluginName, (compilation) => {
      console.log('webpack 构建正在启动！');
    });
  }
}

module.exports = ConsoleLogOnBuildWebpackPlugin;
```
## 二、Webpack 插件

在讲解 `Webpack` 插件之前，我们先回顾一下 `Webpack` 的作用。`Webpack` 是一个 `JS` 打包工具，用于将模块化的 `JavaScript` 应用程序打包成一个或多个 `bundle`，以便在浏览器中使用。

下图引用自官网
![[Pasted image 20240624215007.png]]

我们可以将 `Webpack` 看作是一台机器，输入项目源文件，输出目标文件。

把 `Webpack` 想象成一条果酱加工流水线，那么输入的水果就是我们的项目源文件，而输出的果酱就是我们最终想要的产物文件。在这个过程中，水果经过流水线上一系列的处理流程最终被加工成果酱。
假如现在我们需要加工的过程中给果酱瓶贴上标签，该怎么做呢？我们可以找到果酱在流水线中进行装瓶的位置，然后在这个位置的后面加一个贴标签的机器，这样装瓶后的果酱都会被贴上标签。
在上面的例子中，贴标签的机器就是我们的自定义 `Webpack` 插件，而“果酱装瓶后”这个节点就是 `Webpack` 中一个特定的生命周期。在这里我们可以拿到刚装瓶的果酱，就像是我们可以在 `Webpack` 特定生命周期可以拿到特定的上下文内容一样。然后我们就可以使用这些特定的上下文内容做一些我们想做的事情。这样我们就扩展了 `Webpack` 的功能。

AI
Webpack 是一个现代 JavaScript 应用的静态模块打包工具。可以把 Webpack 想象成一条果酱加工流水线，输入的水果就是我们的项目源文件，输出的果酱就是我们最终的产物文件。在这个过程中，水果经过流水线上一系列的处理流程最终被加工成果酱。

假如现在我们需要在加工过程中给果酱瓶贴上标签，该怎么做呢？我们可以找到果酱在流水线中进行装瓶的位置，然后在这个位置的后面加一个贴标签的机器，这样装瓶后的果酱都会被贴上标签。

在上面的例子中，贴标签的机器就是我们的自定义 Webpack 插件，而“果酱装瓶后”这个节点就是 Webpack 中一个特定的生命周期。在这里我们可以拿到刚装瓶的果酱，就像我们可以在 Webpack 特定生命周期拿到特定的上下文内容一样。然后我们就可以使用这些特定的上下文内容做一些我们想做的事情。这样我们就扩展了 Webpack 的功能。